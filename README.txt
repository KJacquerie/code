----------------------------------------------------------------------------------------------------------------------------------
Robust switches in thalamic network activity require a timescale separation between sodium and T-type calcium channel activations
Kathleen Jacquerie and Guillaume Drion
(October 2020) Julia and Matlab codes related to the article
----------------------------------------------------------------------------------------------------------------------------------


• All code has been checked but is provided *without support or guarantees*
• Please cite the paper if you use the code


You will find a description of the different files and folders below. The first part is composed of the codes used to obtain each figure. The second part describes the codes present in each folder. Don’t forget to add the correct directory in main Julia or Matlab files. Most of the codes take a relatively long amount of time to be run. The data generated by Julia codes are too heavy to be uploaded in the Github, it is the reason why data.dat files are removed. If you are interested in these data, please contact us. Since we use uniform distributions to produce variability in parameter spaces, it is likely that you might not have the exact same results. However, the conclusion remains the same.



-------------------------
 FIGURE 1 | Single-cells
-------------------------

--- Figure 1A ---
Hyperpolarization-induced bursting recording in model 1 (Drion model).

• File: Single-cells>Drion>…
• Run [Julia] Simu_Drion.jl (adapt directory name to save data; writedlm)
• Saved data: 
where? in Single-cells>Drion>V>…
what? time array (t_HIB.dat) and voltage membrane array (V_HIB.dat)
• Plot recording [Matlab] Single-cells>_Analysis>plot_expm.m
• Saved and save figure: Single-cells>_Analysis>Figures>V>Drion_HIB.pdf (ou Drion_HIB.eps)

--- Figure 1B ---
Modified version of Python code from [Alonso and Marder, 2019] Alonso, L. M. and Marder, E. (2019). Visualization of currents in neural models with similar behavior and different conductance densities. eLife, 8:1–28.
Code unavailable | ask permission to the author

--- Figure 1C ---
Hyperpolarization-induced bursting for different values of the membrane capacitance in model 1 (Drion), model 5 (Wang) and model 5’ (WangCa).

For each model, change the folder name.
• File: Singles-cells>name>…
• Run [Julia] Simu_name_plotC.jl (adapt directory name to save data; writedlm)
• Saved data: 
where? in Single-cells>name>V>…
what? 
Nominal value of C: time array (t_C1.dat) and voltage membrane array (V_C1.dat)
Modified value of C: time array (t_C0.dat) and voltage membrane array (V_C0.dat)
• Plot and save figure [Matlab] Single-cells>_Analysis>Figures>V>name_C0.pdf

--- Figure 1D ---
Quantification of switching neuron for varying membrane capacitance value.

• File: Single-cells>name>…
• Run [Julia] Simu_name_logC.jl (adapt directory name to save data; writedlm)
• Saved data: 
Where? In Single-cells>name>Map>…
What? C value array (Cvec.dat), current hyperpolarizing (Ivec.dat), binary matrix (element ij is binary: 1 the neuron has switched, otherwise 0 for C=Cvec(i) and Ivec(j)) (switch_TOT.dat)
• Data analysis [Matlab] Single-cells>_Analysis>Map_logC.m 
• Data plot [Excel]


--------------------
 FIGURE 2 | Network
--------------------

--- Figure 2A ---
Illustration of a rhythmic network from model 1 (Drion) and arrhythmic network from model 5 (Wang)

• File: Network>name>…
• Run [Julia] Simu_name_ncells_4steps.jl  (adapt directory name to save data; writedlm)
• Saved data: 
	Where? In Network>name>V>…
	What? Time array (t_ok for rhythmic network recording or t_ko for an arrhythmic network recording) and membrane voltage (resp.V_ok.dat and V_ko.dat)
• Plot and save figure [Matlab] Network>_Analysis>plot_expm.m

--- Figure 2B ---
Quantitative analysis of rhythmic networks subjected to variabilities onto synaptic conductances and intrinsic conductances.
Source: [Drion et al., 2018] Drion, G., Dethier, J., Franci, A., and Sepulchre, R. (2018). Switchable slow cellular conductances determine robustness and tunability of network states. PLoS Computational Biology, 14(4):1–20.

• File: Network>name>…
• Run [Julia] Simu_name_ncells_gamma.jl (adapt directory folder to save data; cd and writedlm)
• Saved data: 
	Where? In Network>name>Results_GAMMA>…
		Gamma represents the width of the variability interval around nominal values (in %)
	What? 
DC_depol1.dat	value of the duty cycle during depolarization phase
DC_hyperpol1.dat	value of the duty cycle during the hyperpolarization phase
Freq_depol1.dat	value of the tonic frequency during the depolarization phase
Freq_hyperpol1.dat	value of the tonic frequency during the hyperpolarization phase
IBF_depol1.dat	value of the intraburst frequency during the depolarization phase
IBF_hyperpol1.dat	value of the intraburst frequency during the hyperpolarization phase
PER_depol1.dat	value of the bursting period during the depolarization phase
PER_hyperpol1.dat	value of the bursting period during the hyperpolarization phase
SPB_depol1.dat	value of number of spikes per burst during the depolarization phase
SPB_hyerpol1.dat	value of number of spikes per burst during the hyperpolarization phase

• Data analysis [Matlab] Network>_Analysis>switch_bar.m
• Data plot [Matlab & Excel] Network>_Analysis>switch_bar.m 


---------------
 Figure 3 | Tau
---------------

--- Figure 3A ---
[Power point] Schematic draw of the computational experiment 

--- Figure 3B-C ---
Effect on a varying CaT activation time constant on rhythmic network robustness.

• File: Tau>_Analysis>…
• Run [Matlab]: tau_collect.m
• Saved figures: Tau>_Analysis>Figures> TOT_TAU20_new.pdf and SUP_TAU20_new.pdf

-----------------
 Figure 4 | LFP
-----------------

--- Figure 4A-4C ---
[Power point] Schematic network draw


--- Figure 4B- Figure 4D ---
LFP recording of model 1 (Drion) and model 5 (Wang) for no intrinsic and synaptic variabilities. 
Top: evolution of LFP
Bottom: spectrogram of LFP

• File: LFP>name> 
• Run [Julia] Simu_name_LFP_4steps.jl (adapt directory name; writedlm)
• Saved data: #1: total number of cells in the network, #2: variability width in %.
	Where? LFP>name>Results_LFP> n_#1>gamma_#2
	What? LFP_E_#2.dat , LFP_I_#2.dat
• Data analysis and plot [Matlab] LFP>_Analysis>
	plot_LFP.m : plot LFP recording and save it in LFP>_Analysis>Figures>V>LFPtracename_#2.pdf
	LFP_figure_modele.m: plot spectrogram of LFP recording and 
• Plots are saved in LFP>_Analysis>Figures>name_LFP_E_n#1_#2.eps


--------------------
 Figure 5 | LFP_tau
--------------------

--- Figure 5A --- 
[Power point] Schematic draw of the computational experiment.

--- Figure 5B ---
Figures are extracted from Figure 5 to illustrate how we sort data.

--- Figure 5C ---
[Power point] summary of LFP recording and spectrogram analysis 
(that can be found in LFP_TAU>_Analysis>Figures>name>…) 
Functions


----------------------
 Folder: Single-cells
----------------------

--- Map_logC.m
From Julia data (the neuron is switching or not), this function finds the hyperpolarizing current generating the most robust when C is varying for each network.

--- plot_expm.m
Display Figures 1A and 1C.



------------------
 Folder: Network
------------------

--- determ_synburst.m
From Julia data (PER, freq, …) obtained for each circuit, this function determines the state of the circuit (silent, tonic mode, synchron. bursting, asynchron. Bursting)

--- plot_expm.m
Display Figure 2A

--- prop_computation.m: 
Load data generated by Julia
Call function determ_synburst.m
Compute proportion of rhythmic circuits

--- switch_bar.m
Display Figure 2B

-------------
 Folder: TAU
-------------
--- determ_synburst.m
From Julia data (PER, freq, …) obtained for each circuit, this function determines the state of the circuit (silent, tonic mode, synchron. bursting, asynchron. Bursting)


--- plot_tau_curve.m
Function comparing major time constant in a given model.

--- prop_tau.m
Same role as prop_computation.m when time constant is varying.

--- tau_collect_Vtheq.m
Same as Figure 3B-C when the threshold voltage is equal to -50mV for each time constant function.

--- tau_collect.m
Display Figure 3B-C (in our case, the threshold voltage is adapted for each model, since the spike has a different shape in each model).




-------------
 Folder: LFP
-------------

--- LFP_figure_modele.m
Display spectrograms in Figures 4B and 4D (bottom) by calling LFP_figure.m with adapted spectrogram parameters for each model.

--- LFP_figure.m
Load Julia data (LFP recording) and compute the LFP spectrogram.

--- plot_LFP.m
Display Figures 4B and 4D (top) - LFP recording obtained from Julia data.

--- plot_V.m
Function to display recorder membrane voltage to check the shape of the simulation.


-----------------
 Folder: LFP_TAU
-----------------
--- LFP_curve.m
From Julia data (LFP recording), this function processes LFP traces, zoom versions and LFP spectrogram.

--- LFP_figure_modele.m
Display LFP traces and LFP spectrogram by calling LFP_curve.m for each model with the appropriate spectrogram parameters.

--- LFP_figure.m
Load Julia data (LFP recording) and compute the LFP spectrogram.

--- Plot_LFP.m
Display LFP recording from Julia data.
	

